<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>代購活動報名表與市場調查表單網站</title>
  <link rel="stylesheet" href="./style.css" />
  <script src="./script.js" defer></script>
</head>
<body>
<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>代購活動報名表與市場調查表單網站</title>
<style>
@keyframes fadeInScale {
    from { opacity: 0; transform: scale(0.96); }
    to { opacity: 1; transform: scale(1); }
}
.new-row {
    animation: fadeInScale 0.5s ease forwards;
    background-color: #fffae6;
}
</style>
</head>
<body>
<h2>代購活動報名表與市場調查表單網站</h2>
<form id="signupForm">
    姓名：<input type="text" id="inputName"><br>
    性別：<input type="text" id="inputGender"><br>
    年齡：<input type="number" id="inputAge"><br>
    買家 E-mail：<input type="email" id="inputBuyerEmail"><br>
    賣家 E-mail：<input type="email" id="inputSellerEmail"><br>
    代購產品商品的項目名稱：<br>
    <input type="checkbox" name="interest" value="鯊魚夾">鯊魚夾
    <input type="checkbox" name="interest" value="手鍊">手鍊
    <input type="checkbox" name="interest" value="數位文創產品">數位文創產品
    <input type="checkbox" name="interest" value="其他">其他：
    <input type="text" id="inputOther"><br><br>
    <input type="submit" value="送出">
</form>

<h2>報名與市場調查清單</h2>
<table border="1" id="resultTable">
<tr>
    <th>姓名</th>
    <th>性別</th>
    <th>年齡</th>
    <th>買家 E-mail</th>
    <th>賣家 E-mail</th>
    <th>代購產品商品的項目名稱</th>
</tr>
</table>

<br>
<button id="downloadCsvBtn">下載 CSV</button>

<script>
document.getElementById("signupForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const name = document.getElementById("inputName").value.trim();
    const gender = document.getElementById("inputGender").value.trim();
    const age = document.getElementById("inputAge").value.trim();
    const buyerEmail = document.getElementById("inputBuyerEmail").value.trim();
    const sellerEmail = document.getElementById("inputSellerEmail").value.trim();

    const checkboxes = document.querySelectorAll("input[name='interest']:checked");
    let interests = Array.from(checkboxes).map(cb => cb.value);

    const otherValue = document.getElementById("inputOther").value.trim();
    if (interests.includes("其他") && otherValue) {
        interests[interests.indexOf("其他")] = "其他：" + otherValue;
    }

    const table = document.getElementById("resultTable");
    const row = table.insertRow();
    row.classList.add("new-row");

    row.insertCell(0).textContent = name;
    row.insertCell(1).textContent = gender;
    row.insertCell(2).textContent = age;
    row.insertCell(3).textContent = buyerEmail;
    row.insertCell(4).textContent = sellerEmail;
    row.insertCell(5).textContent = interests.join("、");

    document.getElementById("signupForm").reset();
});

// 下載 CSV
document.getElementById("downloadCsvBtn").addEventListener("click", function() {
    const table = document.getElementById("resultTable");
    let csv = [];
    for (let row of table.rows) {
        let cols = [];
        for (let cell of row.cells) {
            let text = cell.innerText.replace(/"/g, '""');
            cols.push(`"${text}"`);
        }
        csv.push(cols.join(","));
    }
    const csvContent = csv.join("\n");
    const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "報名與市場調查清單.csv";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
});
</script>
</body>
</html>
